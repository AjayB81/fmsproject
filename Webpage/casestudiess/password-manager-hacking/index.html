<!doctype html>
<html lang="en">


<!-- Mirrored from www.ise.io/casestudies/password-manager-hacking/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 31 Aug 2023 07:27:39 GMT -->
<head>
    <title>Password Managers: Under the Hood of Secrets Management - Independent Security Evaluators</title>
    <meta charset="utf-8">
	<meta name="description" content="Password managers allow the storage and retrieval of sensitive information from an encrypted database. Users rely on them to provide better security guarantees against trivial exfiltration than alternative ways of storing passwords, such as an unsecured flat text file. In this paper we propose security guarantees password managers should offer and examine the underlying workings of five popular password managers targeting the Windows 10 platform: 1Password 7 [1], 1Password 4 [1], Dashlane [2], KeePass [3], and LastPass [4]." />
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Password Managers: Under the Hood of Secrets Management" />
	<meta property="og:description" content="Password managers allow the storage and retrieval of sensitive information from an encrypted database. Users rely on them to provide better security guarantees against trivial exfiltration than alternative ways of storing passwords, such as an unsecured flat text file. In this paper we propose security guarantees password managers should offer and examine the underlying workings of five popular password managers targeting the Windows 10 platform: 1Password 7 [1], 1Password 4 [1], Dashlane [2], KeePass [3], and LastPass [4]." />
	<meta property="og:url" content="index.html" />
	<meta property="og:site_name" content="Independent Security Evaluators" />
	<meta property="og:image" content="../../assets/img/logo_white_square.png" />
	<meta name="twitter:card" content="summary_large_image" />

    <!-- Required meta tags -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="ahrefs-site-verification" content="79c692fee3854586781d3f86d234931ba3f5a12705c23db76407351e42aa6757">

    <!-- fonts preload -->
    <link rel="preload" href="../../assets/fonts/HK%20Grotesk%20Pro/HKGroteskPro-Regular.woff2" as="font" type="font/woff2" crossorigin/>
    <link rel="preload" href="../../assets/fonts/HK%20Grotesk%20Pro/HKGroteskPro-Medium.woff2" as="font" type="font/woff2" crossorigin/>


    <!-- Libs CSS -->
    <link rel="stylesheet" href="../../assets/fonts/Feather/feather.css">
    <link rel="stylesheet" href="../../assets/libs/%40fancyapps/fancybox/dist/jquery.fancybox.min.css">
    <link rel="stylesheet" href="../../assets/libs/aos/dist/aos.css">

    <!-- <link rel="stylesheet" type="text/css" href="../../assets/font-awesome/css/font-awesome.min.css"> -->
    <link rel="stylesheet" href="../../../unpkg.com/flickity%402.3.0/dist/flickity.min.css">
    <script src="../../../unpkg.com/flickity%402.3.0/dist/flickity.pkgd.min.js"></script>
    <!-- <link rel="stylesheet" href="../../assets/libs/choices.js/public/assets/styles/choices.min.css">
    <link rel="stylesheet" href="../../assets/libs/flickity-fade/flickity-fade.css">
    <link rel="stylesheet" href="../../assets/libs/flickity/dist/flickity.min.css">
    <link rel="stylesheet" href="../../assets/libs/highlightjs/styles/vs2015.css">
    <link rel="stylesheet" href="../../assets/libs/jarallax/dist/jarallax.css">
    <link rel="stylesheet" href="../../assets/libs/quill/dist/quill.core.css" /> -->


    <!-- Font awesome animations -->
    <script src="../../../kit.fontawesome.com/275cf458c9.js" crossorigin="anonymous"></script> 
    <link rel="stylesheet" href="../../../cdnjs.cloudflare.com/ajax/libs/font-awesome-animation/0.3.0/font-awesome-animation.min.css" integrity="sha512-Po8rrCwchD03Wo+2ibHFielZ8luDAVoCyE9i6iFMPyn9+V1tIhGk5wl8iKC9/JfDah5Oe9nV8QzE8HHgjgzp3g==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Theme CSS -->
    <link rel="stylesheet" href="../../assets/css/theme.min.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HZ2ZZMHS4S"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-HZ2ZZMHS4S');
    </script>

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '../../../www.googletagmanager.com/gtm5445.html?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TW7J76M');</script>
    <!-- End Google Tag Manager -->

    <!-- Google Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>

<body>
    
    <!-- NAVBAR
    ================================================== -->
    <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-white">
      <div class="container">

        <!-- Brand -->
        <a class="navbar-brand" href="../../index.html">
          <img src="../../assets/img/brand.svg" class="navbar-brand-img" alt="...">
        </a>

        <!-- Buttons-->
        <div>
          <!-- Start Page Book a Demo Button -->         <!-- Only shows on screen sizes between extra small to medium -->
          <!--
          <a class="btn btn-primary btn-sm lift btn-pd-sm d-xs-block d-lg-none" id="navbar-demo-btn" style="display: none;" rel="noopener">
          Book a Demo</a>-->
          <!-- Toggler -->
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
            aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>

        <!-- Collapse -->
        <div class="collapse navbar-collapse" id="navbarCollapse">

          <!-- Toggler -->
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
            aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fe fe-x"></i>
          </button>

          <!-- Navigation -->
          <ul class="navbar-nav ml-auto">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" id="navbarAbout" data-hover="dropdown" href="../../about/values/index.html" aria-haspopup="true"
                aria-expanded="false">
                About
              </a>
              <div class="dropdown-menu dropdown-menu" aria-labelledby="navbarAbout">
                <div class="row no-gutters">
                  <div class="col-12 col-lg-8">

                    <!-- Heading -->
                    <h6 class="dropdown-header">
                      About ISE
                    </h6>

                    <!-- List -->
                    <a class="dropdown-item" href="../../about/values/index.html" title="Integrity, Quality, Dedication, Education">
                      Company Values
                    </a>                                

                    <a class="dropdown-item" href="../../about/methodology/index.html" title="Learn how we deliver reports">
                      Methodology
                    </a>      

                    <a class="dropdown-item" href="../../about/leadership/index.html" title="Independent Security Evaluators">
                      Leadership
                    </a>      

                    <a class="dropdown-item" href="../../news/index.html" title="Stay up to date">
                      News
                    </a>      

                    <a class="dropdown-item" href="../../careers/index.html" title="Join our team">
                      Careers
                    </a>      

                  </div>
                </div>
              </div>
            </li>



            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" id="navbarServices" data-hover="dropdown" href="../../services/vulnerability-assessments/index.html" aria-haspopup="true"
                aria-expanded="false">
                Services
              </a>
              <div class="dropdown-menu dropdown-menu-lg" aria-labelledby="navbarServices">
                <div class="row no-gutters">
                  <div class="col-12 col-lg-6">

                    <!-- Heading -->
                    <h6 class="dropdown-header">
                      Assessments
                    </h6>

                    <!-- List -->
                    <a class="dropdown-item" href="../../services/vulnerability-assessments/index.html">
                      Vulnerability Assessments
                    </a>
                    <a class="dropdown-item" href="../../services/application-security-assessment/index.html">
                      Application Security Assessments
                    </a>
                    <a class="dropdown-item" href="../../services/cloud-security-assessment/index.html">
                      Cloud Security Assessments
                    </a>
                    <a class="dropdown-item" href="../../services/penetration-testing/index.html">
                      Penetration Testing
                    </a>
                    <a class="dropdown-item" href="../../services/network-penetration-testing/index.html">
                      Network Penetration Testing
                    </a>
                    <a class="dropdown-item mb-5" href="../../services/managed-vulnerability-scanning/index.html">
                      Vulnerability Scanning
                    </a>
                
                    <!-- Heading -->
                    <h6 class="dropdown-header">
                      Hacking Events
                    </h6>

                    <!-- List -->
                    <a class="dropdown-item mb-5" href="https://www.iotvillage.org/" target="_blank" rel="noopener">
                      IoT Village <span class="fe fe-external-link"></span>
                    </a>

                  </div>
                  <div class="col-12 col-lg-6">

                    <!-- Heading -->
                    <h6 class="dropdown-header">
                      Consulting
                    </h6>

                    <!-- List -->
                    <a class="dropdown-item" href="../../services/security-consulting-services/index.html">
                      Security Consulting
                    </a>
                    <a class="dropdown-item" href="../../services/independent-verification-and-validation/index.html">
                      Independent Verification & Validation
                    </a>
                    <a class="dropdown-item" href="../../services/secure-design-analysis/index.html">
                      Secure Design Analysis
                    </a>
                    <a class="dropdown-item mb-5" href="../../services/it-consulting-services/index.html">
                      IT Consulting
                    </a>
                
                    <!-- Heading -->
                    <h6 class="dropdown-header">
                      Training
                    </h6>

                    <!-- List -->
                    <a class="dropdown-item" href="../../services/training/index.html">
                      Security Training
                    </a>

                    <a class="dropdown-item mb-5" href="https://offers.ise.io/ise-application-security-training-workshop" rel="noopener noreferrer" target="_blank">
                      Hackalong <span class="fe fe-external-link"></span>
                    </a>

                  </div>
                </div>
              </div>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" id="navbarResearch" data-hover="dropdown" href="../../research/index.html" aria-haspopup="true"
                aria-expanded="false">
                Research
              </a>
              <div class="dropdown-menu dropdown-menu" aria-labelledby="navbarResearch">

                    <!-- Heading -->
                    <h6 class="dropdown-header">
                      Research
                    </h6>

                    <!-- List -->
                    <a class="dropdown-item" href="../../research/index.html" title="Papers & Studies">
                      Papers & Studies
                    </a>                                

                    <a class="dropdown-item" href="../../talks/index.html" title="Talks">
                      Talks
                    </a>      

                    <a class="dropdown-item" href="../../blog/index.html" title="Hackers Blog">
                      Hackers Blog
                    </a>      

                    <a class="dropdown-item" href="https://blog.ise.io/blog" title="Industry Blog" rel="noopener noreferrer" target="_blank">
                      Industry Blog <span class="fe fe-external-link"></span>
                    </a>      

                    <a class="dropdown-item" href="../../start/blog/index.html" title="Join our team">
                      VRM/TPRM Articles
                    </a>  

                    <a class="dropdown-item" href="../../research/podcast/index.html" title="Join our team">
                      Podcast
                    </a>   
       
                </div>
            </li>

            <!-- Start-->
            <!-- <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" id="navbarStart" data-hover="dropdown" href="../../start/" aria-haspopup="true"
                aria-expanded="false">
                START VRM
              </a>
              <div class="dropdown-menu dropdown-menu-md" aria-labelledby="navbarStart">
                <div class="list-group list-group-flush p-4">

                  <a class="list-group-item" href="../../start/blog/">
                    <div class="ml-4">
                      <h6 class="font-weight-bold text-uppercase text-primary mb-0">
                        Blog
                      </h6>
                    </div>

                  </a>

                </div>
              </div>
            </li> -->
        
            <li class="nav-item dropdown">
              <a class="nav-link" id="navbarStart" href="../../start/index.html">
                START - Vendor Risk Management
              </a>
            </li>


          </ul>
      
          <a class="navbar-btn btn btn-sm btn-primary lift ml-auto"
            href="https://offers.ise.io/ask-an-expert" target="_blank" rel="noopener">
            Ask an Expert
          </a>

        </div>

      </div>
    </nav>

    <!-- CONTENT
    ================================================== -->
    

<section class="py-12">
    <div class="container">
        <div class="row">
            <div class="col-12 col-md-12 col-lg-12" id="content">
                

<article class="post-1410 casestudies type-casestudies status-publish entry">
	<header class="entry-header">
		<h1 class="entry-title">Password Managers: Under the Hood of Secrets Management</h1>
		<p class="entry-meta"><time class="entry-time">February 19, 2019</time> </p>
	</header>
	<div class="entry-content">
		<div id="pl-1410" class="panel-layout">
			<div id="pg-1410-0" class="panel-grid panel-no-style">
				<div id="pgc-1410-0-0" class="panel-grid-cell">
					<div id="panel-1410-0-0-0"
						class="so-panel widget widget_sow-editor panel-first-child panel-last-child widgetopts-SO"
						data-index="0">
						<div id="border-heading" class="panel-widget-style panel-widget-style-for-1410-0-0-0">
							<div class="so-widget-sow-editor so-widget-sow-editor-base">
								<div class="siteorigin-widget-tinymce textwidget">
									<h3><strong><a
												href="https://blog.securityevaluators.com/recovering-the-master-password-from-a-locked-password-manager-1password-4-5d32cd569907"
												target="_blank" rel="noopener">Also see associated blog</a></strong>
									</h3>
									<h3><strong><a
												href="https://blog.securityevaluators.com/faq-common-misunderstandings-around-the-hack-of-a-password-manager-1401cffd24c"
												target="_blank" rel="noopener">FAQ</a></strong></h3>
									<h3><a href="https://www.washingtonpost.com/technology/2019/02/19/password-managers-have-security-flaw-you-should-still-use-one/?utm_term=.569f814dc075"
											target="_blank" rel="noopener">Link to Washington Post Exclusive</a></h3>
									<h2><strong><br />
											Abstract:<span class="Apple-converted-space"> </span></strong></h2>
									<p>Password managers allow the storage and retrieval of sensitive information from
										an encrypted database. Users rely on them to provide better security guarantees
										against trivial exfiltration than alternative ways of storing passwords, such as
										an unsecured flat text file. In this paper we propose security guarantees
										password managers should offer and examine the underlying workings of five
										popular password managers targeting the Windows 10 platform: 1Password 7 [1],
										1Password 4 [1], Dashlane [2], KeePass [3], and LastPass [4]. We anticipated
										that password managers would employ basic security best practices, such as
										scrubbing secrets from memory when they are not in use and sanitization of
										memory once a password manager was logged out and placed into a locked state.
										However, we found that in all password managers we examined, trivial secrets
										extraction was possible from a locked password manager, including the master
										password in some cases, exposing up to 60 million users that use the password
										managers in this study to secrets retrieval from an assumed secure locked
										state.<span class="Apple-converted-space"> </span></p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="pg-1410-1" class="panel-grid panel-no-style">
				<div id="pgc-1410-1-0" class="panel-grid-cell">
					<div id="panel-1410-1-0-0"
						class="so-panel widget widget_sow-editor panel-first-child panel-last-child widgetopts-SO"
						data-index="1">
						<div class="so-widget-sow-editor so-widget-sow-editor-base">
							<div class="siteorigin-widget-tinymce textwidget">
								<h2><strong>Introduction:<span class="Apple-converted-space"> </span></strong></h2>
								<p>First and foremost, password managers are a good thing. All password managers we have
									examined add value to the security posture of secrets management, and as Troy Hunt,
									an active security researcher once wrote, “Password managers don’t have to be
									perfect, they just have to be better than not having one” [5]. Aside from being an
									administrative tool to allow users to categorize and better manage their
									credentials, password managers guide users to avoid bad password practices such as
									using weak passwords, common passwords, generic passwords, and password reuse.<span
										class="Apple-converted-space"> </span></p>
								<p>The tradeoff is that users’ credentials are then centrally stored and managed,
									typically protected by a single master password to unlock a password manager data
									store. With the rising popularity of password manager use it is safe to assume that
									adversarial activity will target the growing user base of these password managers.
									Table 1, below, outlines the number of individual users and business entities for
									each of the password managers we examine in this paper.<span
										class="Apple-converted-space"> </span></p>
								<p>&nbsp;</p>
								<table style="background-color: #e8e8e8;" cellspacing="0" cellpadding="0">
									<tbody>
										<tr>
											<td valign="top"><strong>Password Manager<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top"><strong>Users<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top"><strong>Business Entities<span
														class="Apple-converted-space"> </span></strong></td>
										</tr>
										<tr>
											<td valign="top"><strong>1Password<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top">15,000,000 [6]<span class="Apple-converted-space"> </span>
											</td>
											<td valign="top">30,000 [6]<span class="Apple-converted-space"> </span></td>
										</tr>
										<tr>
											<td valign="top"><strong>Dashlane<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top">10,000,000 [7]<span class="Apple-converted-space"> </span>
											</td>
											<td valign="top">10,000 [7]<span class="Apple-converted-space"> </span></td>
										</tr>
										<tr>
											<td valign="top"><strong>KeePass<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top">20,000,000 [8]<span class="Apple-converted-space"> </span>
											</td>
											<td valign="top">Unknown<span class="Apple-converted-space"> </span></td>
										</tr>
										<tr>
											<td valign="top"><strong>LastPass<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top">16,500,000 [9]<span class="Apple-converted-space"> </span>
											</td>
											<td valign="top">43,000 [9]<span class="Apple-converted-space"> </span></td>
										</tr>
									</tbody>
								</table>
								<p><i>Table 1. Number of private users and business entities of 1Password (all
										versions), Dashlane, KeePass and LastPass.<span
											class="Apple-converted-space"> </span></i></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="pg-1410-2" class="panel-grid panel-no-style">
				<div id="pgc-1410-2-0" class="panel-grid-cell">
					<div id="panel-1410-2-0-0"
						class="so-panel widget widget_sow-editor panel-first-child panel-last-child widgetopts-SO"
						data-index="2">
						<div class="so-widget-sow-editor so-widget-sow-editor-base">
							<div class="siteorigin-widget-tinymce textwidget">
								<h2><strong>Motivation:<span class="Apple-converted-space"> </span></strong></h2>
								<p>With the proliferation of online services, password use has gone from about 25
									passwords per user in 2007 [10] to 130 in 2015 and is projected to grow to 207 in
									2020 [11]. This, combined with a userbase of 60 million across password managers we
									examine in this paper, creates a target rich environment in which adversaries can
									carefully craft methods to extract an increasingly growing and valuable trove of
									secrets and credentials.<span class="Apple-converted-space"> </span></p>
								<p>An example in which a password manager appears to have been specifically targeted is
									an attack that led to the loss of 2578 units of Ethereum (ETH), a cryptocurrency
									valued at the time of 1.5 million USD. The attack was carried out against a
									cryptocurrency trading assistant platform, Taylor [12]. Taylor issued a statement
									that indicated a device which was using 1Password for secrets management was
									compromised [13]. It remains unclear, whether the attacker found a security issue in
									1Password itself or simply discovered the master password in some other way, or
									whether the compromise had nothing to do with password managers.</p>
								<p>Given the combination of an increasing number of credentials held in password
									managers, the value of those secrets and the emerging threats specifically targeting
									password managers it is important for us to examine the increased risk a user or
									organization faces in terms of secrets exposure when using a password manager. Our
									approach for this was to survey popular password managers to determine common
									defenses they employ against secrets exfiltration. We incorporate the best security
									features of each into a hypothetical, best possible password manager, that provides
									a minimum set of guarantees outlined in the next section. Then we compare the
									password managers studied against those security guarantees.<span
										class="Apple-converted-space"> </span></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="pg-1410-3" class="panel-grid panel-no-style">
				<div id="pgc-1410-3-0" class="panel-grid-cell">
					<div id="panel-1410-3-0-0"
						class="so-panel widget widget_sow-editor panel-first-child panel-last-child widgetopts-SO"
						data-index="3">
						<div class="so-widget-sow-editor so-widget-sow-editor-base">
							<div class="siteorigin-widget-tinymce textwidget">
								<h2><strong>Password Manager Security Guarantees:<span
											class="Apple-converted-space"> </span></strong></h2>
								<p>All password managers studied work in the same basic way. Users enter or generate
									passwords in the software and add any pertinent metadata (e.g., answers to security
									questions, and the site the password goes to). This information is encrypted and
									then decrypted only when it is needed for display, for passing to a browser add-on
									that fills the password into a website, or for copying to the clipboard for
									use.<span class="Apple-converted-space"> </span></p>
								<p>Throughout this paper we will refer to password managers in three states of
									existence: not running, unlocked (and running), and locked (and running; this state
									assumes the password manager was previously unlocked). We assume that the user does
									not have additional layers of encryption such as full disk encryption or per process
									virtualization. We define the three states below:<span
										class="Apple-converted-space"> </span></p>
								<p><b><i>Not Running<span class="Apple-converted-space"> </span></i></b></p>
								<p>We define “not running” as a state where the password manager has previously been
									installed, configured, and interacted with by the user to store secrets, but has not
									been launched since the last reboot or has been terminated by the user since it was
									last used.<span class="Apple-converted-space"> </span></p>
								<p>In this “not running” state the password manager should guarantee:<span
										class="Apple-converted-space"> </span></p>
								<ul>
									<li>There should be no data stored on disk that would offer an attacker leverage
										toward compromising the database stored on disk (e.g. the master password or
										encryption key stored in a configuration file).<span
											class="Apple-converted-space"> </span></li>
									<li>Even if an attacker retrieves the password database from disk, it should be
										encrypted in such a way that an attacker cannot decrypt it without knowing the
										master password.<span class="Apple-converted-space"> </span></li>
									<li>The encryption should be designed in such a way that, so long as the user did
										not use a trivial password, the attacker cannot brute force guess the master
										password in a reasonable amount of time using commonly available computing
										resources.<span class="Apple-converted-space"> </span></li>
								</ul>
								<p><b><i>Running: Unlocked State<span class="Apple-converted-space"> </span></i></b></p>
								<p>We define running in an “unlocked state” as cases where the password manager is
									running, and where the user has typed in the master password in order to decrypt and
									access the stored passwords inside the manager. The user may have displayed, copied
									to clipboard, or otherwise accessed some of the passwords in the password
									manager.<span class="Apple-converted-space"> </span></p>
								<p>In this “running, unlocked state” the password manager should guarantee:<span
										class="Apple-converted-space"> </span></p>
								<ul>
									<li>It should not be possible to extract the master password from memory, either
										directly or in any form that allows the original master password to be
										recovered.<span class="Apple-converted-space"> </span></li>
									<li>For those stored passwords that have <i>not </i>been displayed/copied/accessed
										by the user since the password manager was unlocked, it should not be possible
										to extract those unencrypted passwords from memory.<span
											class="Apple-converted-space"> </span></li>
								</ul>
								<p>Knowing usability constraints that affect password managers, we concede that:<span
										class="Apple-converted-space"> </span></p>
								<ul>
									<li>It may be possible to extract those passwords from memory that were
										displayed/copied/accessed in the current unlocked session.<span
											class="Apple-converted-space"> </span></li>
									<li>It may be possible to extract cryptographic information derived from the master
										password sufficient to decrypt other stored passwords, but not the master
										password itself.<span class="Apple-converted-space"> </span></li>
								</ul>
								<p><b><i>Running: Locked State<span class="Apple-converted-space"> </span></i></b></p>
								<p>We define “in locked state” as cases where (1) the password manager was just launched
									but the user has not entered the master password yet, or (2) the user previously
									entered the master password and used the password manager, but subsequently clicked
									the ‘Lock’ or ‘Log Out’ button.<span class="Apple-converted-space"> </span></p>
								<p>In this “running, locked state” the password manager should guarantee:<span
										class="Apple-converted-space"> </span></p>
								<ul>
									<li>All the security guarantees of a not-running password manager should apply to a
										password manager that is in the locked state.<span
											class="Apple-converted-space"> </span></li>
								</ul>
								<p>Since a locked password manager still exists as a process in virtual memory, this
									requires additional guarantees:<span class="Apple-converted-space"> </span></p>
								<ul>
									<li>It should not be possible to extract the master password from memory, either
										directly or in any form that allows the original master password to be
										recovered.<span class="Apple-converted-space"> </span></li>
									<li>It should not be possible to extract from memory any cryptographic information
										derived from the master password that might allow passwords to be decrypted
										without knowing the master password.<span class="Apple-converted-space"> </span>
									</li>
									<li>It should not be possible to extract any unencrypted passwords from memory that
										are stored in the password manager.<span class="Apple-converted-space"> </span>
									</li>
								</ul>
								<p>In addition to these explicit security guarantees, we expect password managers to
									incorporate additional hardening measures where possible, and to have these
									hardening measures enabled by default. For example, password managers should attempt
									to block software keystroke loggers from accessing the master password as it is
									typed, attempt to limit the exposure of unencrypted passwords left on the clipboard,
									and take reasonable steps to detect and block modification or patching of the
									password manager and its supporting libraries that might expose passwords.<span
										class="Apple-converted-space"> </span></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="pg-1410-4" class="panel-grid panel-no-style">
				<div id="pgc-1410-4-0" class="panel-grid-cell">
					<div id="panel-1410-4-0-0"
						class="so-panel widget widget_sow-editor panel-first-child panel-last-child widgetopts-SO"
						data-index="4">
						<div class="so-widget-sow-editor so-widget-sow-editor-base">
							<div class="siteorigin-widget-tinymce textwidget">
								<h2><strong>Scope:<span class="Apple-converted-space"> </span></strong></h2>
								<p>In this paper we will examine the inner workings as they relate to secrets retrieval
									and storage of 1Password, Dashlane, KeePass and LastPass on the Windows 10 platform
									(Version 1803 Build 17134.345) using an Intel i7-7700HQ processor. We examine
									susceptibility of a password manager to secrets exfiltration via examination of the
									password database on disk; memory forensics; and finally, keylogging, clipboard
									monitoring, and binary modification. Each password manager is examined in its
									default configuration after install with no advanced configuration steps
									performed.<span class="Apple-converted-space"> </span></p>
								<p>The focus on our evaluation of password managers is limited to the Windows platform.
									Our findings can be extrapolated to password manager implementations in other
									operating systems to guide research to areas of interest that are discussed in this
									paper.<span class="Apple-converted-space"> </span></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="pg-1410-5" class="panel-grid panel-no-style">
				<div id="pgc-1410-5-0" class="panel-grid-cell">
					<div id="panel-1410-5-0-0"
						class="so-panel widget widget_sow-editor panel-first-child panel-last-child widgetopts-SO"
						data-index="5">
						<div class="so-widget-sow-editor so-widget-sow-editor-base">
							<div class="siteorigin-widget-tinymce textwidget">
								<h2><strong>Target Password Managers:</strong></h2>
								<p>The following password managers with their corresponding versions were evaluated:</p>
								<table style="background-color: #e8e8e8;" cellspacing="0" cellpadding="0">
									<tbody>
										<tr>
											<td valign="top"><strong>Product<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top"><strong>Version<span
														class="Apple-converted-space"> </span></strong></td>
										</tr>
										<tr>
											<td valign="top"><strong>1Password4 for Windows<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top">4.6.2.626<span class="Apple-converted-space"> </span></td>
										</tr>
										<tr>
											<td valign="top"><strong>1Password7 for Windows<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top">7.2.576<span class="Apple-converted-space"> </span></td>
										</tr>
										<tr>
											<td valign="top"><strong>Dashlane for Windows<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top">6.1843.0<span class="Apple-converted-space"> </span></td>
										</tr>
										<tr>
											<td valign="top"><strong>KeePass Password Safe<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top">2.40<span class="Apple-converted-space"> </span></td>
										</tr>
										<tr>
											<td valign="top"><strong>LastPass for Applications<span
														class="Apple-converted-space"> </span></strong></td>
											<td valign="top">4.1.59<span class="Apple-converted-space"> </span></td>
										</tr>
									</tbody>
								</table>
								<h2></h2>
								<h2><strong>Security of Password Managers in the Non-Running State</strong></h2>
								<p>We first consider the security of password managers when they are not running. We
									focus on the attack vector of compromising passwords from disk. Unless password
									managers have severe vulnerabilities such as logging passwords to unencrypted log
									files or other egregious issues, the password managers’ defenses against the disk
									attack surface rest on the cryptography used to protect the password database. Here,
									we examine which algorithm each password manager uses to transform the master
									password into an encryption key, and whether the algorithm and number of iterations
									is severely lacking in its ability to resist contemporary cracking attacks.</p>
								<p>Table 2, below, outlines the key expansion algorithm type used and number of
									iterations in each password manager’s default configuration. With regard to key
									expansion recommendations set by NIST [14]we found that each key expansion algorithm
									used in the password managers was acceptable and that the number of iterations
									adequate. We concluded that the password managers were secure against compromising
									passwords from disk as the software is not running, and that brute forcing the
									encrypted password entries on disk would be computationally prohibitive, although
									not impossible if given enough computing resources. Given this, we moved on to the
									attack surface of passwords stored in memory while the password managers are
									running.</p>
								<table style="background-color: #e8e8e8;">
									<tbody>
										<tr>
											<td width="126"><strong>Password Manager</strong></td>
											<td width="150"><strong>Key Expansion Algorithm</strong></td>
											<td width="172"><strong>Iterations</strong></td>
										</tr>
										<tr>
											<td width="126"><strong>1Password4</strong></td>
											<td width="150">PBKDF2-SHA256</td>
											<td width="172">40,000 [15]</td>
										</tr>
										<tr>
											<td width="126"><strong>1Password7</strong></td>
											<td width="150">PBKDF2-SHA256</td>
											<td width="172">100,000 [16]</td>
										</tr>
										<tr>
											<td width="126"><strong>Dashlane</strong></td>
											<td width="150">Argon2</td>
											<td width="172">3 [17]</td>
										</tr>
										<tr>
											<td width="126"><strong>KeePass</strong></td>
											<td width="150">AES-KDF</td>
											<td width="172">60,000 [18]</td>
										</tr>
										<tr>
											<td width="126"><strong>LastPass</strong></td>
											<td width="150">PBKDF2-SHA256</td>
											<td width="172">100,100 [19]</td>
										</tr>
									</tbody>
								</table>
								<p><em>Table 2. Each password managers default key expansion algorithm and number of
										iterations.</em></p>
								<p>&nbsp;</p>
								<h2><strong>Security of Password Managers in Running States</strong></h2>
								<p>We expected and found that all password managers reviewed sufficiently protect the
									master password and individual passwords while they are <em>not</em>running. The
									remaining bulk of our assessment of password managers in the running state was
									focused on the effectiveness of the locked state and whether the unlocked state left
									the minimum possible amount of sensitive information in memory. The following
									sections outline violations of our proposed security guarantees of password managers
									in a running locked and unlocked state.</p>
								<p>&nbsp;</p>
								<h2><strong>1Password4 (Version: 4.6.2.626)</strong></h2>
								<p>We assessed the security of 1Password4 while running and found reasonable protections
									against exposure of individual passwords in the unlocked state; unfortunately, this
									was overshadowed by its handling of the master password and several broken
									implementation details when transitioning from the unlocked to the locked state. On
									the positive side, we found that as a user accesses different entries in 1Password4,
									the software is careful to clear the previous unencrypted password from memory
									before loading another. This means that only one unencrypted password can be in
									memory at once. On the negative side, the master password remains in memory when
									unlocked (albeit in obfuscated form) and the software fails to scrub the obfuscated
									password memory region sufficiently when transitioning from the unlocked to the
									locked state. We also found a bug where, under certain user actions, the master
									password can be left in memory in cleartext even while locked.</p>
								<p>&nbsp;</p>
								<h2><strong>Failure to Scrub Obfuscated Master Password from Memory</strong></h2>
								<p>It is possible to recover and deobfuscate the master password from 1Password4 since
									it is not scrubbed from memory after placing the password manager in a locked state.
									Given a scenario where a user has unlocked 1Password4 and then placed it back into a
									locked state, 1Password4 will prompt for the master password again as shown in
									Figure 1below. However, 1Password4 retains the master password in memory, although
									in an encoded/obfuscated format as shown in Figure 2.</p>
								<p><img class="alignnone wp-image-1411"
										src="../../wp-content/uploads/2019/02/Picture1.jpg" alt="Figure 1. 1Password4 in a locked state awaiting master password input." width="532"
										height="142"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture1.jpg 337w, https://www.ise.io/wp-content/uploads/2019/02/Picture1-300x80.jpg 300w"
										sizes="(max-width: 532px) 100vw, 532px" /></p>
								<p><em>Figure 1. 1Password4 in a locked state awaiting master password input.</em></p>
								<p>&nbsp;</p>
								<p><img class="alignnone wp-image-1421"
										src="../../wp-content/uploads/2019/02/Picture2.jpg" alt="Figure 2. Encoded master password present in memory while 1Password4 is in a
										locked state." width="529"
										height="65"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture2.jpg 391w, https://www.ise.io/wp-content/uploads/2019/02/Picture2-300x37.jpg 300w"
										sizes="(max-width: 529px) 100vw, 529px" /></p>
								<p><em>Figure 2. Encoded master password present in memory while 1Password4 is in a
										locked state.</em></p>
								<p>&nbsp;</p>
								<p>We can use this information to intercept normal workflows in which 1Password4 calls
									RtlRunEncodeUnicodeString and RtlRunDecodeUnicodeString to obfuscate the master
									password to instead reveal the already present, but encoded master password into
									cleartext (Figure 3).</p>
								<p><img class="alignnone wp-image-1420"
										src="../../wp-content/uploads/2019/02/Picture3.jpg" alt="Figure 3. Master password revealed after the expected  RtlRunEncodeUnicodeString
										and RtlRunDecodeUnicodeString was reversed, thereby forcing 1Password4 to decode
										the encoded master password that was not scrubbed from memory." width="560"
										height="56"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture3.jpg 390w, https://www.ise.io/wp-content/uploads/2019/02/Picture3-300x30.jpg 300w"
										sizes="(max-width: 560px) 100vw, 560px" /></p>
								<p><em>Figure 3. Master password revealed after the expected  RtlRunEncodeUnicodeString
										and RtlRunDecodeUnicodeString was reversed, thereby forcing 1Password4 to decode
										the encoded master password that was not scrubbed from memory.</em></p>
								<p>&nbsp;</p>
								<h2><strong>Copying the Current Password Entry from Memory</strong></h2>
								<p>Only entries that are actively being interacted with exist in memory as plaintext.
									Figure 4is an example of an entry in memory as its being interacted with. Once
									1Password4 is locked, the memory region is deallocated . Note that the deallocated
									region is not first scrubbed, however the Windows memory manager will zero out any
									freed pages of memory before making them available for re-allocation by the Windows
									memory manager.</p>
								<p><img /><img class="alignnone wp-image-1419"
										src="../../wp-content/uploads/2019/02/Picture4.jpg" alt="Figure 4. Password entry in memory during active interaction." width="550"
										height="218"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture4.jpg 358w, https://www.ise.io/wp-content/uploads/2019/02/Picture4-300x119.jpg 300w"
										sizes="(max-width: 550px) 100vw, 550px" /></p>
								<p><em>Figure 4. Password entry in memory during active interaction.</em></p>
								<p>&nbsp;</p>
								<h2><strong>1Password7 (Version: 7.2.576)</strong></h2>
								<p>After assessing the legacy 1Password4, we moved on to 1Password7, the current
									release. Surprisingly, we found that it is less secure in the running state compared
									to 1Password4. 1Password7 decrypted all individual passwords in our test database as
									soon as it is unlocked and caches them in memory, unlike 1Password4 which kept only
									one entry at a time in memory. Compounding this, we found that 1Password7 scrubs
									neither the individual passwords, the master password, nor the secret key (an extra
									field introduced in 1Password6 that combines with the master password to derive the
									encryption key) from memory when transitioning from unlocked to locked. This renders
									the “lock” button ineffective; from the security standpoint, after unlocking and
									using 1Password7, the user must exit the software entirely in order to clear
									sensitive information from memory as locking should.</p>
								<p>It appears 1Password may have rewritten their software to produce 1Password7 without
									implementing secure memory management and secrets scrubbing workflows present in
									1Password4 and abandoning the distinction between a ‘running unlocked’ and ‘running
									locked’ state in terms of secrets exposure. Interestingly, this is not the case.
									Prior marketing material for  1Password claimed [20]to feature Intel SGX technology.
									This technology protects secrets inside secure memory enclaves so that other
									processes and even higher privileged components (such as the kernel) cannot access
									them. Were SGX to be implemented correctly, 1Password7 would have been the most
									secure password manager in our research by far. Unfortunately, SGX was only
									supported as a beta feature in 1Password6 and early versions of 1Password7, and was
									dropped for later versions. This was only evident from gathering the details about
									it on a 1Password support forum [21].</p>
								<p>&nbsp;</p>
								<h2><strong>Exposure of Cleartext Master Password, Secret Key and Entries in
										Memory</strong></h2>
								<p>As stated before, all secrets are exposed by 1Password7 when in an unlocked and
									locked state. To demonstrate the severity of this issue we created proof of concept
									code to read 1Password7’s memory address space to extract these items. The proof of
									concept applications ran in the existing user context (which was an ordinary
									non-administrative user).</p>
								<p>Show below is 1Password7 in a locked state, Figure 5(having previously been unlocked
									but then again locked) awaiting password entry to unlock it.</p>
								<p><img class="alignnone wp-image-1418"
										src="../../wp-content/uploads/2019/02/Picture5.jpg" alt="Figure 5. 1Password7 in a locked state, having previously been open and then
										locked." width="382"
										height="264" /></p>
								<p><em>Figure 5. 1Password7 in a locked state, having previously been open and then
										locked.</em></p>
								<p>&nbsp;</p>
								<p>Figure 6 illustrates the automated retrieval of the master password.</p>
								<p><img class="alignnone wp-image-1417"
										src="../../wp-content/uploads/2019/02/Picture6.jpg" alt="Figure 6. Extracting the master password from a locked 1Password7 instance" width="562"
										height="207"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture6.jpg 304w, https://www.ise.io/wp-content/uploads/2019/02/Picture6-300x111.jpg 300w"
										sizes="(max-width: 562px) 100vw, 562px" /></p>
								<p><em>Figure 6. Extracting the master password from a locked 1Password7 instance</em>
								</p>
								<p>&nbsp;</p>
								<p>Figure 7 shows the extraction of the secret key that is needed along with the master
									password to unlock an encrypted database, and Figure 8shows the automated extraction
									of secret entries.</p>
								<p><img class="alignnone wp-image-1416"
										src="../../wp-content/uploads/2019/02/Picture7.jpg" alt="Figure 7. Extracting the secret key from 1Password7 in a locked state." width="596"
										height="179"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture7.jpg 356w, https://www.ise.io/wp-content/uploads/2019/02/Picture7-300x90.jpg 300w"
										sizes="(max-width: 596px) 100vw, 596px" /></p>
								<p><em>Figure 7. Extracting the secret key from 1Password7 in a locked state.</em></p>
								<p>&nbsp;</p>
								<p><img class="alignnone wp-image-1415"
										src="../../wp-content/uploads/2019/02/Picture8.jpg" alt="Figure 8. Extracting password entries from a locked instance of 1Password7." width="560"
										height="419" /><img /></p>
								<p><em>Figure 8. Extracting password entries from a locked instance of 1Password7.</em>
								</p>
								<p>&nbsp;</p>
								<p>The memory “hygiene” of 1Password7 is so lacking, that it is possible for it to leak
									passwords from memory without an intentional attack at all. During our evaluation of
									1Password7, we encountered a system stop error (kernel mode exception) on our
									Windows 10 workstation, from an unrelated hardware issue, that created a full memory
									debug dump to disk. While examining this memory dump file, we came across our
									secrets that 1Password7 held cleartext, in memory, in a locked state when the stop
									error occurred (Figure 9).</p>
								<p><img class="alignnone wp-image-1413"
										src="../../wp-content/uploads/2019/02/Picture9.jpg" alt="Figure 9. Windows 10 crash dump file contained secrets 1Password7 held in memory
										in a locked state." width="669"
										height="97"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture9.jpg 421w, https://www.ise.io/wp-content/uploads/2019/02/Picture9-300x43.jpg 300w"
										sizes="(max-width: 669px) 100vw, 669px" /></p>
								<p><em>Figure 9. Windows 10 crash dump file contained secrets 1Password7 held in memory
										in a locked state.</em></p>
								<p>&nbsp;</p>
								<p>For all password managers that leave secrets in memory, this creates a threat model
									where secrets may be extracted in a non-running state as a by-product of system
									activity and/or crash/debug log files. Moreover, some companies have a policy to
									image workstations that have had malware encounters as part of the incident response
									procedure. A user that happened to be running 1Password7 while this procedure was
									initiated should assume that all secrets have been compromis</p>
								<p>&nbsp;</p>
								<h2><strong>Dashlane (Version: 6.1843.0)</strong></h2>
								<p>In our Dashlane evaluation, we noted workflows that indicate focus was placed on
									concealing secrets in memory to reduce their likelihood of extraction. Also, unique
									to Dashlane, was the usage of memory/string and GUI management frameworks that
									prevented secrets from being passed around to various OS API’s that could expose
									them to eavesdropping by trivial malware.</p>
								<p>Similar to 1Password4, Dashlane exposes only the active entry a user is interacting
									with. So, at most, the last active entry is exposed in memory while Dashlane is in
									an unlocked and locked state. However, once a user updates any information in an
									entry, Dashlane exposes the entire database plaintext in memory and it remains there
									even after Dashlane is logged out of or ‘locked’.</p>
								<p>&nbsp;</p>
								<h2><strong>Exposure of Cleartext Entries in Memory</strong></h2>
								<p>Password entries in Dashlane are stored in an XML object. Upon interacting with any
									entry this XML object becomes exposed in cleartext and can be easily extracted in
									both locked and unlocked states. Figure 10, below, is an example of a portion of
									this XML data structure.</p>
								<p><img class="alignnone wp-image-1414"
										src="../../wp-content/uploads/2019/02/Picture10.jpg" alt="Figure 10. Excerpt of a fully decrypted Dashlane XML password database in an unlocked
										and locked state." width="683"
										height="174"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture10.jpg 459w, https://www.ise.io/wp-content/uploads/2019/02/Picture10-300x76.jpg 300w"
										sizes="(max-width: 683px) 100vw, 683px" /></p>
								<p>Figure 10. Excerpt of a fully decrypted Dashlane XML password database in an unlocked
									and locked state.</p>
								<p>&nbsp;</p>
								<p>Knowing that this data structure exists in a locked state, we then created a proof of
									concept application to extract it from a locked instance of Dashlane. Figure 11,
									below, is a locked instance of Dashlane prompting for the master password to unlock
									it.</p>
								<p><img class="alignnone wp-image-1412"
										src="../../wp-content/uploads/2019/02/Picture11.jpg" alt="Figure 11. Locked instance of Dashlane." width="304"
										height="382" /></p>
								<p><em>Figure 11. Locked instance of Dashlane.</em></p>
								<p>&nbsp;</p>
								<p>In this locked state, we then run our proof of concept to extract all stored secrets
									(Figure 12).</p>
								<p><img class="alignnone wp-image-1422"
										src="../../wp-content/uploads/2019/02/Picture12.jpg" alt="Figure 12. Extracting secrets from a locked instance of Dashlane." width="531"
										height="154"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture12.jpg 379w, https://www.ise.io/wp-content/uploads/2019/02/Picture12-300x87.jpg 300w"
										sizes="(max-width: 531px) 100vw, 531px" /></p>
								<p><em>Figure 12. Extracting secrets from a locked instance of Dashlane.</em></p>
								<p>&nbsp;</p>
								<p>However, even though we are able to extract secrets from a locked state of Dashlane,
									the memory region they reside in has been dereferenced and freed. So, over time
									portions of the XML data structure may be overwritten. Throughout our examination,
									we noticed that secrets may reside for a few minutes. In some instances, we have
									observed them still resident in memory more than 24 hours.</p>
								<p>Dashlane is also unique compared to the other password managers in our examination in
									that it does not allow you to exit the process via GUI components, such as clicking
									the close program [x] in the upper right or pressing the ALT-F4 key combination.
									Doing so causes Dashlane to minimize into the task tray, leaving it susceptible to
									secrets extraction for extended periods of time.</p>
								<p>&nbsp;</p>
								<h2><strong>KeePass (Version: 2.40)</strong></h2>
								<p>Unlike the other password managers, KeePass is an open source project. Similar to
									1Password4, KeePass decrypts entries as they are interacted with, however, they all
									remain in memory since they are not individually scrubbed after each interaction.
									The master password is scrubbed from memory and not recoverable. However, while
									KeePass attempts to keep secrets secure by scrubbing them from memory, there are
									obviously errors in these workflows as we have discovered that while even in a
									locked state, we were able to extract entries that had been interacted with.</p>
								<p>KeePass claims to use several defenses in depth memory protection mechanisms as
									stated in an excerpt from their site below (Figure 13). However, they acknowledge
									that these workflows may involve Windows OS API’s that may make copies of various
									memory buffers which may not be exposed to KeePass for scrubbing.</p>
								<p><img class="alignnone wp-image-1431"
										src="../../wp-content/uploads/2019/02/Picture13.jpg" alt="Figure 13. KeePass statement on memory protection." width="514"
										height="147"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture13.jpg 346w, https://www.ise.io/wp-content/uploads/2019/02/Picture13-300x86.jpg 300w"
										sizes="(max-width: 514px) 100vw, 514px" /></p>
								<p><em>Figure 13. KeePass statement on memory protection.</em></p>
								<p>&nbsp;</p>
								<h2><strong>Exposure of Cleartext Entries in Memory</strong></h2>
								<p>Entries that have been interacted with remain exposed in memory even after KeePass
									has been placed into a locked state. Figure 14, below, is an example of a locked
									instance of KeePass prompting for the master password before it can be unlocked.</p>
								<p><img class="alignnone wp-image-1430"
										src="../../wp-content/uploads/2019/02/Picture14.jpg" alt="Figure 14. Locked instance of KeePass." width="437"
										height="315" /></p>
								<p><em>Figure 14. Locked instance of KeePass.</em></p>
								<p>&nbsp;</p>
								<p>Secrets are scattered in memory with no references. However, performing a simple
									strings dump from the process memory of KeePass reveals a list of entries that have
									been interacted with (Figure 15).</p>
								<p><img class="alignnone wp-image-1429"
										src="../../wp-content/uploads/2019/02/Picture15.jpg" alt="Figure 15. List of entries from a locked instance of KeePass." width="598"
										height="278"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture15.jpg 359w, https://www.ise.io/wp-content/uploads/2019/02/Picture15-300x140.jpg 300w"
										sizes="(max-width: 598px) 100vw, 598px" /></p>
								<p><em>Figure 15. List of entries from a locked instance of KeePass.</em></p>
								<p>&nbsp;</p>
								<p>Using the above information, we can then search for a username to an entry and locate
									its corresponding password field entry, in the below image (Figure16) we locate the
									bitcoin private key which was stored in the password field.</p>
								<p><img class="alignnone wp-image-1428"
										src="../../wp-content/uploads/2019/02/Picture16.jpg" alt="Figure 16. Locating a bitcoin private key via its corresponding public
										key/username." width="602"
										height="148"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture16.jpg 439w, https://www.ise.io/wp-content/uploads/2019/02/Picture16-300x74.jpg 300w"
										sizes="(max-width: 602px) 100vw, 602px" /></p>
								<p><em>Figure 16. Locating a bitcoin private key via its corresponding public
										key/username.</em></p>
								<p>&nbsp;</p>
								<p>The above methodology can be used to extract any entries that have been interacted
									with before placing KeePass into a locked state.</p>
								<p>&nbsp;</p>
								<h2><strong>LastPass (Version: 4.1.59)</strong></h2>
								<p>Similar to 1Password4, LastPass obfuscates the master password as its being typed
									into the unlock field. Once the decryption key has been derived from the master
									password, the master password is overwritten with the phrase “lastpass rocks”
									(Figure17).</p>
								<p><img class="alignnone wp-image-1427"
										src="../../wp-content/uploads/2019/02/Picture17.jpg" alt="Figure 17. Master password overwritten once the master password has been used in
										a PBKDF2 key expansion routine." width="570"
										height="114"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture17.jpg 350w, https://www.ise.io/wp-content/uploads/2019/02/Picture17-300x60.jpg 300w"
										sizes="(max-width: 570px) 100vw, 570px" /></p>
								<p><em>Figure 17. Master password overwritten once the master password has been used in
										a PBKDF2 key expansion routine.</em></p>
								<p>&nbsp;</p>
								<p>Once LastPass enters an unlocked state, database entries are decrypted into memory
									only upon user interaction. However, these entries persist in memory even after
									LastPass has been placed back into a locked state.</p>
								<p>&nbsp;</p>
								<h2><strong>Exposure of Cleartext Master Password and Entries in Memory</strong></h2>
								<p>During a workflow to derive the decryption key, the master password is leaked into a
									string buffer in memory and never scrubbed, even when LastPass is placed into a
									locked state.</p>
								<p>The below image, Figure 18, is an instance of LastPass in a locked state awaiting
									user entry of the master password.</p>
								<p><img class="alignnone wp-image-1426"
										src="../../wp-content/uploads/2019/02/Picture18.jpg" alt="Figure 18. Locked instance of LastPass." width="252"
										height="379" /></p>
								<p><em>Figure 18. Locked instance of LastPass.</em></p>
								<p>&nbsp;</p>
								<p>In this locked state, we can recover the master password and any interacted with
									password entries with the same methodology used in KeePass, in which a simple
									strings dump was performed on the active process.</p>
								<p>The image below, Figure19, is an example of recovering the master password, in a
									locked state, which ironically is always found within a few lines of ‘lastpass
									rocks’, the phrase used to conceal the master password in another buffer.</p>
								<p><img class="alignnone wp-image-1425"
										src="../../wp-content/uploads/2019/02/Picture19.jpg" alt="Figure 19. Master password in cleartext (underlined red) typically within a few
										lines of ‘lastpass rocks’." width="417"
										height="198" /></p>
								<p><em>Figure 19. Master password in cleartext (underlined red) typically within a few
										lines of ‘lastpass rocks’.</em></p>
								<p>&nbsp;</p>
								<p>Strings encapsulated by a ‘&lt;input hwnd=’ tag will allow us to enumerate all secret
									entries that have been interacted with. Below, Figure 20, is an example of
									extracting a private key to a bitcoin wallet.</p>
								<p><img class="alignnone wp-image-1424"
										src="../../wp-content/uploads/2019/02/Picture20.jpg" alt="Figure 20. Extracting a bitcoin private key from a locked instance of
										LastPass." width="606"
										height="74"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture20.jpg 352w, https://www.ise.io/wp-content/uploads/2019/02/Picture20-300x37.jpg 300w"
										sizes="(max-width: 606px) 100vw, 606px" /></p>
								<p><em>Figure 20. Extracting a bitcoin private key from a locked instance of
										LastPass.</em></p>
								<p>&nbsp;</p>
								<h2><strong>Conclusion:</strong></h2>
								<p>All password managers we examined sufficiently secured user secrets while in a ‘not
									running’ state. That is, if a password database were to be extracted from disk and
									if a strong master password was used, then brute forcing of a password manager would
									be computationally prohibitive.</p>
								<p>Each password manager also attempted to scrub secrets from memory. But residual
									buffers remained that contained secrets, most likely due to memory leaks, lost
									memory references, or complex GUI frameworks which do not expose internal memory
									management mechanisms to sanitize secrets.</p>
								<p>This was most evident in 1Password7 where secrets, including the master password and
									its associated secret key, were present in both a locked and unlocked state. This is
									in contrast to 1Password4, where at most, a single entry is exposed in a ‘running
									unlocked’ state and the master password exists in memory in an obfuscated form, but
									is easily recoverable. If 1Password4 scrubbed the master password memory region upon
									successful unlocking, it would comply with all proposed security guarantees we
									outlined earlier.</p>
								<p>This paper is not meant to criticize specific password manager implementations;
									however, it is to establish a reasonable minimum baseline which all password
									managers should comply with. It is evident that attempts are made to scrub and
									sensitive memory in all password managers. <strong><u>However, each password manager
											fails in implementing proper secrets sanitization for various reasons.
										</u></strong></p>
								<p>The image below, Figure 21, summarizes the results of our evaluation:</p>
								<p><img class="alignnone wp-image-1423"
										src="../../wp-content/uploads/2019/02/Picture21.jpg" alt="Figure 21. Summary of each password managers security items we examined." width="598"
										height="183"
										srcset="https://www.ise.io/wp-content/uploads/2019/02/Picture21.jpg 461w, https://www.ise.io/wp-content/uploads/2019/02/Picture21-300x92.jpg 300w"
										sizes="(max-width: 598px) 100vw, 598px" /></p>
								<p><em>Figure 21. Summary of each password managers security items we examined.</em></p>
								<p>&nbsp;</p>
								<p>Keylogging and Clipboard sniffing are known risks and only included for user
									awareness, that no matter how closely a password manager may adhere to our proposed
									‘Security Guarantees’, victims of keylogging or clipboard sniffing malware/methods
									have no protection. However, significant violations of our proposed security
									guarantees are highlighted in red. In an unlocked state, all or a majority of secret
									records should not be extracted into memory.  Only a single one, being actively
									viewed, should be extracted. Also, in an unlocked state, the master password should
									not be present in either an encrypted or obfuscated form.</p>
								<p>A locked running state that exposes interacted with or all records puts users’ secret
									records unnecessarily at risk. <strong><u>Most egregious is the presence of a master
											password in a locked state.</u></strong></p>
								<p>It is unknown how widespread this knowledge is amongst adversaries. However, up to 60
									million users of these password managers potentially are at risk of a targeted
									attack directed at the software that is meant to safeguard their secrets.</p>
								<p><strong><u>In our opinion, the most urgent item is to sanitize secrets when a
											password manager is placed into a locked state</u></strong>. Typically, most
									password managers place themselves into this locked state after a certain period of
									user inactivity, after this the process may remain indefinitely either until the OS
									is restarted, the process is terminated by the user, or the process restarts itself
									as part of a self-update workflow when a new version is published. This creates a
									large window of time in which secrets for certain password managers reside cleartext
									in memory and available for extraction.</p>
								<p>In addition to providing a minimum set of guarantees users can rely on, creators of
									password managers should employ additional defenses to protect secrets by:</p>
								<ul>
									<li>Detecting or employing methods to, by default, thwart software based keyloggers
									</li>
									<li>Preventing secrets exposure in an unlocked state</li>
									<li>Employing hardware-based features (such as SGX) to make it more difficult to
										extract secrets</li>
									<li>Employing trivial malware and runtime process modification detection mechanisms
									</li>
									<li>Employing per-install binary scrambling during the install phase to make each
										instance a unique binary layout to thwart trivial and advanced targeted malware
									</li>
									<li>Limiting the traversal of secrets to OS provided APIs by implementing custom GUI
										elements and memory management to limit secrets exposure to well-known APIs that
										can be targeted by malware authors</li>
								</ul>
								<p>End users should, as always, employ security best practices to limit exposure to
									adversarial activity, such as:</p>
								<ul>
									<li>Keeping the OS updated</li>
									<li>Enabling or utilizing well known and tested anti-virus solutions</li>
									<li>Utilizing features provided by some password managers, such as “Secure Desktop”
									</li>
									<li>Using hardware wallets for immediately exploitable sensitive data such as crypto
										currency private keys</li>
									<li>Utilizing the auto lock feature of their OS to prevent ‘walk by’ targeted
										malicious activity</li>
									<li>Selecting a strong password as the master password to thwart brute force
										possibilities on a compromised encrypted database file</li>
									<li>Using full disk encryption to prevent the possibility of secrets extraction in
										the event of crash logs and associated memory dumps which may include decrypted
										password manager data</li>
									<li>Shutting a password manager down completely when not in use even in a locked
										state (If using one that doesn’t properly sanitize secrets upon being placed
										into a locked running state)</li>
								</ul>
								<p>&nbsp;</p>
								<h2><strong>Future Research:</strong></h2>
								<p>Password managers are an important and increasingly necessary part of our lives. In
									our opinion, users should expect that their secrets are safeguarded according to a
									minimum set of standards that we outlined as ‘security guarantees’. Initially our
									assumption and expectation were that password managers are designed to safeguard
									secrets in a ‘non-running state’, which we identified as true. However, we were
									surprised in the inconsistency in secrets sanitization and retention in memory when
									in a running unlocked state and, more importantly, when placed into a locked state.
								</p>
								<p>If password managers fail to sanitize secrets in a locked running state then this
									will be the low hanging fruit, that provides the path of least resistance, to
									successful compromise of a password manager running on a user’s workstation.</p>
								<p>Once the minimum set of ‘security guarantees’ is met then password managers should be
									re-evaluated to discover new attack vectors that adversaries may use to compromise
									password managers and examine possible mitigations for them.</p>
								<p>&nbsp;</p>
								<h2><strong>References:</strong></h2>
								<table width="100%">
									<tbody>
										<tr>
											<td width="1%">[1]</td>
											<td>"1Password," [Online]. Available: https://1password.com.</td>
										</tr>
										<tr>
											<td width="1%">[2]</td>
											<td>"Dashlane," [Online]. Available: https://www.dashlane.com/.</td>
										</tr>
										<tr>
											<td width="1%">[3]</td>
											<td>"KeePass," [Online]. Available: https://keepass.info/.</td>
										</tr>
										<tr>
											<td width="1%">[4]</td>
											<td>"LastPass," [Online]. Available: https://www.lastpass.com/.</td>
										</tr>
										<tr>
											<td width="1%">[5]</td>
											<td>T. Hunt. [Online]. Available:
												https://www.troyhunt.com/password-managers-dont-have-to-be-perfect-they-just-have-to-be-better-than-not-having-one/.
											</td>
										</tr>
										<tr>
											<td width="1%">[6]</td>
											<td>"https://twitter.com/roustem," [Online].</td>
										</tr>
										<tr>
											<td width="1%">[7]</td>
											<td>"https://blog.dashlane.com/10-million-users/," [Online].</td>
										</tr>
										<tr>
											<td width="1%">[8]</td>
											<td>"https://keepass.info/help/kb/trust.html," [Online].</td>
										</tr>
										<tr>
											<td width="1%">[9]</td>
											<td>"https://www.lastpass.com/," [Online].</td>
										</tr>
										<tr>
											<td width="1%">[10]</td>
											<td>D. Florencio, C. Herley and P. C. v. Oorschot, "An Administrator’s Guide
												to Internet Password Research," [Online]. Available:
												https://www.microsoft.com/en-us/research/wp-content/uploads/2014/11/WhatsaSysadminToDo.pdf.
											</td>
										</tr>
										<tr>
											<td width="1%">[11]</td>
											<td>T. L. Bras, "Online Overload – It’s Worse Than You Thought," [Online].
												Available:
												https://blog.dashlane.com/infographic-online-overload-its-worse-than-you-thought/.
											</td>
										</tr>
										<tr>
											<td width="1%">[12]</td>
											<td>"Smart Taylor," [Online]. Available: https://smarttaylor.io/.</td>
										</tr>
										<tr>
											<td width="1%">[13]</td>
											<td>Taylor. [Online]. Available:
												https://medium.com/smarttaylor/updates-on-the-taylor-hack-incident-8843238d1670.
											</td>
										</tr>
										<tr>
											<td width="1%">[14]</td>
											<td>[Online]. Available:
												http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-132.pdf.
											</td>
										</tr>
										<tr>
											<td width="1%">[15]</td>
											<td>[Online]. Available: https://support.1password.com/pbkdf2/.</td>
										</tr>
										<tr>
											<td width="1%">[16]</td>
											<td>"https://support.1password.com/pbkdf2/," [Online].</td>
										</tr>
										<tr>
											<td width="1%">[17]</td>
											<td>"https://www.dashlane.com/download/Dashlane_SecurityWhitePaper_October2018.pdf,"
												[Online].</td>
										</tr>
										<tr>
											<td width="1%">[18]</td>
											<td>"https://keepass.info/help/base/security.html," [Online].</td>
										</tr>
										<tr>
											<td width="1%">[19]</td>
											<td>"LastPass," [Online]. Available:
												https://blog.lastpass.com/2018/07/lastpass-bugcrowd-update.html/.</td>
										</tr>
										<tr>
											<td width="1%">[20]</td>
											<td>J. Goldberg, "Using Intel’s SGX to keep secrets even safer," [Online].
												Available:
												https://blog.1password.com/using-intels-sgx-to-keep-secrets-even-safer/.
											</td>
										</tr>
										<tr>
											<td width="1%">[21]</td>
											<td>"1Password support forum," [Online]. Available:
												https://discussions.agilebits.com/discussion/87834/intel-sgx-stopped-working-its-working-but-the-option-is-not-in-yet.
											</td>
										</tr>
									</tbody>
								</table>
								<p>&nbsp;</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<footer class="entry-footer"></footer>
</article>
            </div>
        </div>
    </div>
</section>


    <!-- SHAPE
    ================================================== -->
    <div class="position-relative">
    <div class="shape shape-bottom shape-fluid-x svg-shim text-gray-200">
        <svg viewBox="0 0 2880 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 48h2880V0h-720C1442.5 52 720 0 720 0H0v48z" fill="currentColor"/></svg>
    </div>
    </div>

    <!-- FOOTER
    ================================================== -->
    <footer class="py-8 py-md-11 bg-gray-200">
      <div class="container">
        <div class="row">
          <div class="col-12 col-md-2">

            <!-- Brand -->
            <img src="../../assets/img/brand-text.svg" alt="..." class="footer-brand img-fluid mb-2">


            <!-- Social -->
            <ul class="list-unstyled list-inline list-social mb-6 mb-md-0">
              <li class="list-inline-item list-social-item mr-3">
                <a href="https://www.linkedin.com/company/independent-security-evaluators" class="text-decoration-none" rel="noopener">
                  <img src="../../assets/img/icons/social/linkedin.svg" class="list-social-icon" alt="...">
                </a>
              </li>
              <li class="list-inline-item list-social-item mr-3">
                <a href="https://facebook.com/ISE.infosec" class="text-decoration-none" rel="noopener">
                  <img src="../../assets/img/icons/social/facebook.svg" class="list-social-icon" alt="...">
                </a>
              </li>
              <li class="list-inline-item list-social-item mr-3">
                <a href="https://twitter.com/ISEsecurity" class="text-decoration-none" rel="noopener">
                  <img src="../../assets/img/icons/social/twitter.svg" class="list-social-icon" alt="...">
                </a>
              </li>
            </ul>

            <div class="py-4">

              <!-- Heading -->
              <h6 class="font-weight-bold text-uppercase text-gray-700">
                <a href="../../contact/index.html">Contact Us</a>
              </h6>
  
            </div>
  
            <div>
  
              <!-- Heading -->
              <h6 class="font-weight-bold text-uppercase text-gray-700">
                <a href="../../privacy-policy/index.html">Privacy Policy</a>
              </h6>
  
            </div>

          </div>
          <div class="col-6 col-md-2">

            <!-- Heading -->
            <h6 class="font-weight-bold text-uppercase text-gray-700">
              About
            </h6>

            <!-- List -->
            <ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0">
              <li class="mb-3">
                <a href="../../about/values/index.html" class="text-reset">
                  Company Values
                </a>
              </li>
              <li class="mb-3">
                <a href="../../about/methodology/index.html" class="text-reset">
                  Methodology
                </a>
              </li>
              <li class="mb-3">
                <a href="../../about/leadership/index.html" class="text-reset">
                  Leadership
                </a>
              </li>
              <li class="mb-3">
                <a href="../../news/index.html" class="text-reset">
                  News
                </a>
              </li>
              <li>
                <a href="../../careers/index.html" class="text-reset">
                  Careers
                </a>
              </li>
            </ul>

          </div>
          <div class="col-6 col-md-2">

            <!-- Heading -->
            <h6 class="font-weight-bold text-uppercase text-gray-700">
              Services
            </h6>

            <!-- List -->
            <ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0">
              <li class="mb-3">
                <a href="../../services/vulnerability-assessments/index.html" class="text-reset">
                  Assessments
                </a>
              </li>
              <li class="mb-3">
                <a href="../../services/security-consulting-services/index.html" class="text-reset">
                  Consulting
                </a>
              </li>
              <li class="mb-3">
                <a href="https://www.iotvillage.org/" target="_blank" class="text-reset" rel="noopener">
                  IoT Village <span class="fe fe-external-link"></span>
                </a>
              </li>
              <li">
                <a href="../../services/training/index.html" class="text-reset" rel="noopener">
                  Training
                </a>
              </li>
            </ul>

          </div>
          <div class="col-6 col-md-2">

            <!-- Heading -->
            <h6 class="font-weight-bold text-uppercase text-gray-700">
              Research
            </h6>

            <!-- List -->
            <ul class="list-unstyled text-muted mb-0">
              <li class="mb-3">
                <a href="../../research/index.html" class="text-reset">
                  Studies & Papers
                </a>
              </li>
              <li class="mb-3">
                <a href="../../talks/index.html" class="text-reset">
                  Talks
                </a>
              </li>
              <li class="mb-3">
                <a href="../../blog/index.html" class="text-reset" rel="noopener">
                  Blog <span class="fe fe-external-link"></span>
                </a>
              </li>
              <li class="mb-3">
                <a href="../../start/blog/index.html" class="text-reset" rel="noopener">
                  VRM/TPRM Articles
                </a>

            </ul>

          </div>

          <div class="col-12 col-md-4">
            <h6 class="font-weight-bold text-uppercase text-gray-700">
              Stay up to date on the latest research and industry trends. Sign up for our newsletter
            </h6>
            <!-- Heading -->
            <!--[if lte IE 8]>
            <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
            <![endif]-->
            <script charset="utf-8" type="text/javascript" src="../../../js.hsforms.net/forms/v2.js"></script>
            <script>
            hbspt.forms.create({
            region: "na1",
            portalId: "7197110",
            formId: "e868052f-9574-4c5b-a8e0-6233b8b6b6d2"
            });
            </script>

          </div>

        </div> <!-- / .row -->
      </div> <!-- / .container -->
    </footer>

    <!-- JAVASCRIPT
    ================================================== -->
    <!-- Libs JS -->
    <script src="../../assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="../../assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/libs/%40fancyapps/fancybox/dist/jquery.fancybox.min.js"></script>
    <script src="../../assets/libs/aos/dist/aos.js"></script>

    <!-- <script src="../../assets/libs/choices.js/public/assets/scripts/choices.min.js"></script> -->
    <!-- <script src="../../assets/libs/countup.js/dist/countUp.min.js"></script> -->
    <!-- <script src="../../assets/libs/dropzone/dist/min/dropzone.min.js"></script> -->
    <!-- <script src="../../assets/libs/flickity/dist/flickity.pkgd.min.js"></script>
    <script src="../../assets/libs/flickity-fade/flickity-fade.js"></script>
    <script src="../../assets/libs/highlightjs/highlight.pack.min.js"></script> -->
    <script src="../../assets/libs/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <!-- <script src="../../assets/libs/isotope-layout/dist/isotope.pkgd.min.js"></script> -->
    <!-- <script src="../../assets/libs/jarallax/dist/jarallax.min.js"></script> -->
    <!-- <script src="../../assets/libs/jarallax/dist/jarallax-video.min.js"></script> -->
    <!-- <script src="../../assets/libs/jarallax/dist/jarallax-element.min.js"></script> -->
    <!-- <script src="../../assets/libs/quill/dist/quill.min.js"></script> -->
    <!-- <script src="../../assets/libs/smooth-scroll/dist/smooth-scroll.min.js"></script> -->
     <script src="../../assets/libs/typed.js/lib/typed.min.js"></script>

    <!-- Map -->
    <!-- <script src='https://api.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script> -->

    <!-- Theme JS -->
    <script src="../../assets/js/theme.min.js"></script>


</body>


<!-- Mirrored from www.ise.io/casestudies/password-manager-hacking/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 31 Aug 2023 07:27:53 GMT -->
</html>